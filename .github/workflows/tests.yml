name: "Tests"
on:
  pull_request:
    types: [ opened, synchronize, reopened ]
    branches:
      - master
    tags:
      - ci
      - tests  
    paths-ignore:
    - .gitignore
    - LICENSE.md
    - README.md

  push:
    branches:
      - master
    tags:
      - ci
      - tests  
    paths-ignore:
    - .gitignore
    - LICENSE.md
    - README.md

jobs:
  precommit:
    runs-on: ubuntu-latest
    container: python:3.9.13-slim-buster
    env:
      HADOLINT_VERSION: 2.10.0
    steps:
      - name: Install Deps
        shell: bash
        run: |
          apt-get -y update
          apt-get -y install --no-install-recommends wget git
          wget -O /usr/local/bin/hadolint https://github.com/hadolint/hadolint/releases/download/v${{ env.HADOLINT_VERSION }}/hadolint-Linux-arm64
          chmod u+x /usr/local/bin/*
          apt-get clean
          rm -rf /var/lib/apt/lists/*

          python3 -m pip install pre-commit 
          pre-commit install
      - uses: actions/checkout@v3
      - name: Hooks
        shell: bash
        run: |      
          pre-commit run --all-files

          